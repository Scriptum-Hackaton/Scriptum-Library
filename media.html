<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Controle por M√£o - MediaPipe</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      line-height: 1.6;
      padding: 20px;
      background: lightblue;
      overflow: hidden; /* Impede o scroll da p√°gina */
    }
  
    #input_video, #output_canvas {
      position: absolute;
      bottom: 20px;
      right: 20px;
      width: 320px;
      height: 240px;
      border-radius: 8px;
      z-index: 100;
      transform: translate3d(0, 0, 0); /* For√ßa o uso de renderiza√ß√£o acelerada pelo hardware */
      pointer-events: none; /* Impede que o canvas interfira com os controles */
    }
  
    #output_canvas {
      pointer-events: none;
    }
  
    .conteudo {
      max-width: 800px;
      margin: auto;
    }
  
    h1 {
      text-align: center;
      font-size: 2.5em;
      margin-top: 60px;
    }

    @media (max-width: 600px) {
  #input_video, #output_canvas {
    width: 100%;
    height: auto;
    bottom: 0;
    right: 0;
    border-radius: 0;
  }
}

  </style>
  
</head>
<body>

  <button id="ativarControle" style="position: fixed; top: 20px; right: 120px; z-index: 200;">
    Ativar Controle por M√£o
  </button>
  
  <button id="pararControle" style="position: fixed; top: 20px; right: 20px; z-index: 200;">
    Parar Controle por M√£o
  </button>
  

  <h1>Controle de Scroll com a M√£o üñêÔ∏è</h1>
  <div class="conteudo">
    <!-- Texto longo para teste de rolagem -->
    <p>
      O nome verdadeiro da estagi√°ria era Maria Am√©lia, mas como todos na fam√≠lia desde sempre a chamaram Pris, foi com esse apelido que ela se apresentou aos colegas na Grande Biblioteca. Uma das bibliotec√°rias perguntou se os pais dela eram f√£s de Blade runner mas foram obrigados a lhe dar o nome das av√≥s por press√£o familiar. N√£o, n√£o era isso, mas n√£o era a primeira vez que Pris ouvia que seu apelido tinha a ver com esse filme. Precisava assisti-lo qualquer dia.

      Pris, estudante de letras que amava livros e lembrava com carinho da mo√ßa da pequena biblioteca da escola onde estudou, ficou feliz em conseguir um est√°gio num local para ela t√£o mitol√≥gico. Emprestar livros para a popula√ß√£o e ajudar as pessoas a escolherem suas leituras parecia-lhe o melhor trabalho do mundo. At√© a realidade cair pesadamente sobre ela.
      
      A estagi√°ria n√£o conseguia conviver com a agressividade das pessoas. Quando um leitor grosseiro ou impaciente a tratava mal, ficava completamente sem a√ß√£o e chegava a chorar. O colegas mais velhos tentavam ensin√°-la a lidar com os ‚Äúossos‚Äù, explicavam que n√£o podia ser t√£o sens√≠vel e ‚Äúlevar para o pessoal‚Äù, mas n√£o adiantava. Pris simplesmente n√£o conseguia entender como algu√©m podia tratar mal uma pessoa que n√£o apenas estava trabalhando, mas tentando sinceramente ajudar. O chefe logo percebeu isso e a afastou um pouco do contato com o p√∫blico. Pris ficou meio triste com isso, mas entendeu, e como amava mesmo os livros, sentia-se feliz em guard√°-los nas estantes, trocar etiquetas e separar os que precisavam de reparos. E ainda havia momentos em que ela ficava no balc√£o de atendimento, cobrindo hor√°rio de jantar dos colegas.
      
      Parecia estar tudo bem assim, at√© que o Nojento a descobriu. O Nojento era o usu√°rio mais detestado pelos funcion√°rios da Grande Biblioteca. O homem n√£o chegava a ser abertamente grosseiro, mas conseguia ser extremamente desagrad√°vel apenas com um olhar ou um coment√°rio ir√¥nico, particularmente se era atendido por um funcion√°rio negro, mulher ou nitidamente homossexual, como era o caso do chefe da Pris. Esse era o √∫nico que n√£o se deixava afetar pelo Nojento, porque tamb√©m sabia usar apenas um olhar para colocar as pessoas em seu devido lugar. Diziam que o Nojento era membro de uma organiza√ß√£o fascista, mas ningu√©m, conseguiu descobrir nada sobre a criatura. ‚Äú√â s√≥ uma cria do inferno nascida do cu de um dem√¥nio de segunda‚Äù, dizia uma das mo√ßas da faxina, desbocada e muito respeitada por essa qualidade. E o Nojento, com seu cabelo ensebado e seu queixo de Goebbels, come√ßou a frequentar a Grande Biblioteca justamente no hor√°rio em que Pris estava atendendo e que seu chefe j√° havia ido embora. O homem parecia gostar dela, ainda que de forma desprez√≠vel. Fazia elogios ao seu cabelo e roupas, olhava para a mo√ßa com aquele olhar que os homens parecem praticar em frente ao espelho para provocar repulsa nas mulheres e at√© chegou a levar um chocolate vagabundo de presente, atirado √† lixeira assim que o desinfeliz virou as costas.
      
      Pris estava come√ßando a entrar em desespero. Quanto mais ela demonstrava sua avers√£o, mais o homem parecia decidido a importun√°-la, divertindo-se com a afli√ß√£o da estagi√°ria. E o pior √© que n√£o havia nada de concreto que pudesse motivar uma reclama√ß√£o. Pris receava que lhe dissessem que precisava aprender a lidar com ‚Äúgalanteios‚Äù, como j√° ouvira uma vez na faculdade, e tinha medo de que a mandassem embora por ser uma pessoa ‚Äúdif√≠cil‚Äù, que chorava √† toa e criava problemas. Os colegas diziam que n√£o, que ningu√©m faria isso com ela, mas Pris tinha d√∫vidas. At√© o chefe, que a entendia e protegia, parecia n√£o ter muita certeza da rea√ß√£o da chefe da Grande Biblioteca, que n√£o gostava de lidar com esse tipo de problema.
      
      Naquele dia, ela n√£o estava no balc√£o de empr√©stimos no hor√°rio habitual, porque dois dos colegas estavam trabalhando at√© mais tarde, pagando horas devidas, e aproveitou para ir resolver um problema na impressora de etiquetas na sala da cataloga√ß√£o. O Alencar viu, com desgosto, o Nojento entrar pela porta, j√° com aquele sorriso seboso na cara, sorriso que se apagou assim que n√£o viu sua presa. O desgra√ßado ficou por ali de bobeira por uns minutos, mexendo no expositor de livros novos, at√© que Alencar e a colega de balc√£o se distra√≠ram com uns jovens perdidos no universo dos cat√°logos e o perderam de vista. Desconfiado, Alencar foi dar uma busca e viu o sujeito entrar na √°rea reservada aos funcion√°rios, furtivo.
      
      Nesse dia, a bibliotec√°ria que dava plant√£o noturno era a Fernanda, do Departamento de Aquisi√ß√µes. Fernandona, como a chamavam os poucos funcion√°rios que n√£o tinham medo dela, era uma ex-jogadora de basquete e maratonista de exatos um metro e oitenta e quatro, uma negra de bra√ßos fortes, sorriso glorioso e fama de n√£o levar desaforo para casa. Alencar avisou, ‚Äú√¥ Fernanda, o cara que persegue a menina foi atr√°s dela l√° no fundo, vou chamar o seguran√ßa‚Äù.
      
      ‚Äì Espera um pouco a√≠ ‚Äì avisou Fernanda, que j√° conhecia o sujeito e a hist√≥ria toda do ass√©dio a Pris, erguendo-se nos saltos at√© atingir quase um metro e noventa.
      
      Alencar achou melhor n√£o discutir, s√≥ ligou discretamente para a portaria enquanto a Fernandona marchava para a porta dos servi√ßos internos. O Nojento estava l√°, no largo corredor cheio de portas, provavelmente esperando a estagi√°ria aparecer.
      
      ‚Äì Procurando o qu√™, amigo? ‚Äì a bibliotec√°ria falou alto, sem se preocupar em ser educada. Educa√ß√£o n√£o se aplicava ao caso.
      ‚Äì Calma a√≠, negona. O banheiro n√£o √© mais aqui?
      
      Fernanda percebeu alguma coisa estranha no ar, algo pesado e viscoso. Como se tivesse entrado num ambiente contaminado ou num matadouro. O homem sorria, provocador, e ela avan√ßou, sentindo o tigre subir dentro de si. Como no dia em que impediu o pai de bater na m√£e, como na ocasi√£o em que reagiu na rua a uma ofensa racista e quase foi presa. Empurrou o homem de encontro √† parede, com toda a for√ßa, segurou-o pelo pesco√ßo com as duas m√£os e apertou um pouco, cheia de repugn√¢ncia. O Nojento tentou se debater, mas Fernanda era bem mais forte do que ele e ambos sabiam disso. Falou baixo e pausadamente, deixando o tigre rosnar livremente:
      
      ‚Äì Voc√™ sabe que n√£o. E sabe tamb√©m que n√£o vai voltar aqui nunca mais e, se voltar, vai ser de cabe√ßa baixa, olhando pro ch√£o. Voc√™ NUNCA MAIS vai dizer outra palavra nesta biblioteca que n√£o seja ‚Äúpor favor‚Äù e ‚Äúmuito obrigado‚Äù e NUNCA MAIS vai olhar para aquela menina. Entendeu? Fui negra e clara?
      
      Assim que o homem conseguiu abanar a cabe√ßa em concord√¢ncia, Fernanda o deixou ir. Saiu apressado, quase correndo, mas ainda conseguiu ensaiar um vago gesto de despedida para Alencar e os demais, que o olhavam perplexos. Para manter um resto de dignidade, sem d√∫vida. A bibliotec√°ria veio logo atr√°s, sentindo o tigre recuar lentamente. O ar do grande sal√£o de entrada tamb√©m parecia sujo, como se o homem em fuga tivesse deixado pra tr√°s a sua nuvem escura.
      
      Fernanda ficou um pouco por ali, parada, tentando se recompor. Sentia nojo das m√£os que haviam tocado no homem e uma vaga sensa√ß√£o de mal-estar parecia correr pelas suas veias. E foi nesse momento que entrou o Franc√™s.
      
      Alain era um professor da universidade que frequentava bastante a se√ß√£o de obras raras, para alguma pesquisa acad√™mica. Muito gentil, embora reservado, era bastante querido por todos os funcion√°rios. As meninas o achavam bonito, embora fosse apenas um intelectual ossudo e meio velhusco, porque havia uma do√ßura em suas maneiras que encantava de imediato. No exato instante em que ele entrou, Fernanda percebeu que o ar pesado se dissipava, dando lugar a uma luminosidade diferente da luz habitual do ambiente. Ao v√™-la ali parada, ainda meio em choque com o que acabara de fazer, o Franc√™s se aproximou e perguntou, com seu sotaque forte:
      
      ‚Äì Que foi, Fernanda? Tudo bem com voc√™?
      
      ‚Äì Tudo bem, meu lindo. Foi s√≥ uma coisa estranha que eu precisei fazer e que me deixou nervosa.
      
      Alain franziu a testa e alisou levemente a lateral do bra√ßo da bibliotec√°ria, num gesto de consolo.  Mais calma, Fernanda agradeceu pela preocupa√ß√£o, fez um sinal de positivo para o seguran√ßa que havia chegado com cara de ponto de interroga√ß√£o e foram todos cuidar de suas vidas. A luz leve e brilhante que entrou com o Franc√™s j√° havia tomado todo o espa√ßo a√©reo da Grande Biblioteca.
      
      O Nojento nunca mais apareceu e Pris nem ficou sabendo da hist√≥ria. Combinaram de n√£o contar nada para n√£o assust√°-la mais ainda. Apenas soube, por Alencar, que a Fernandona tinha algo a ver com o desaparecimento do ‚Äúencosto‚Äù e a abra√ßou muito. Meses depois foi aberto um concurso p√∫blico, com duas vagas para a Grande Biblioteca e ela se inscreveu. Decidira, afinal, que trabalhar em biblioteca era o que desejava da vida, apesar dos percal√ßos todos. O chefe disse que, √† medida que ela fosse ficando mais velha, as pessoas naturalmente a respeitariam mais. E depois, com a maturidade as l√°grimas tendem a secar.  Mais tarde, pensava Pris,  poderia pensar em cursar Biblioteconomia. Por que n√£o?
      </p>
    <!-- Repita esse par√°grafo v√°rias vezes como quiser -->
    <p>
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer vel lorem justo...
    </p>
    <p>
      <!-- Copie/cole mais conte√∫do aqui para testar o scroll -->
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris placerat bibendum risus a posuere...
    </p>
  </div>

  <video id="input_video" autoplay muted></video>
  <canvas id="output_canvas"></canvas>

  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

  <script>
    const videoElement = document.getElementById('input_video');
    const canvasElement = document.getElementById('output_canvas');
    const canvasCtx = canvasElement.getContext('2d');
  
    const hands = new Hands({
      locateFile: (file) => {
        return `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`;
      }
    });
  
    hands.setOptions({
      maxNumHands: 2,
      modelComplexity: 1,
      minDetectionConfidence: 0.7,
      minTrackingConfidence: 0.7
    });
  
    let lastScrollY = null;
    let lastZoomDist = null;
    let zoomScale = 1;
  
    hands.onResults((results) => {
      canvasCtx.save();
      canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);
      canvasCtx.drawImage(results.image, 0, 0, canvasElement.width, canvasElement.height);
  
      const handsLandmarks = results.multiHandLandmarks;
      const handedness = results.multiHandedness;
  
      if (handsLandmarks && handedness) {
        for (let i = 0; i < handsLandmarks.length; i++) {
          const landmarks = handsLandmarks[i];
          const handLabel = handedness[i].label; // "Left" ou "Right"
  
          const polegar = landmarks[4];
          const indicador = landmarks[8];
          const centro = landmarks[9];
  
          const dx = polegar.x - indicador.x;
          const dy = polegar.y - indicador.y;
          const distancia = Math.sqrt(dx * dx + dy * dy);
  
          // Desenhar pontos no canvas
          [polegar, indicador].forEach((ponto) => {
            canvasCtx.beginPath();
            canvasCtx.arc(ponto.x * canvasElement.width, ponto.y * canvasElement.height, 5, 0, 2 * Math.PI);
            canvasCtx.fillStyle = handLabel === "Right" ? "blue" : "red";
            canvasCtx.fill();
          });
  
          // INVERTE os controles por causa da imagem espelhada
          if (handLabel === "Left") {
            // Scroll com a m√£o visualmente esquerda (handLabel = Left)
            if (distancia < 0.05) {
              const y = centro.y * canvasElement.height;
              if (lastScrollY !== null) {
                const deltaY = y - lastScrollY;
                window.scrollBy(0, deltaY * 9); // sensibilidade de scroll
              }
              lastScrollY = y;
            } else {
              lastScrollY = null;
            }
          }
  
          if (handLabel === "Right") {
            // Zoom com a m√£o visualmente direita (handLabel = Right)
            if (lastZoomDist !== null) {
              const delta = distancia - lastZoomDist;
              zoomScale += delta * 1.5; // sensibilidade reduzida
              zoomScale = Math.max(0.5, Math.min(zoomScale, 3));
              document.body.style.transform = `scale(${zoomScale})`;
              document.body.style.transformOrigin = "center center";
            }
            lastZoomDist = distancia;
          }
        }
      } else {
        lastScrollY = null;
        lastZoomDist = null;
      }
  
      canvasCtx.restore();
    });
  
    const camera = new Camera(videoElement, {
      onFrame: async () => {
        await hands.send({ image: videoElement });
      },
      width: 320,
      height: 240
    });
  
    camera.start();

    //outros trampos \
    
  </script>
  
  
  
  
  
</body>
</html>